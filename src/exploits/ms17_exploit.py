#!/usr/bin/env python3
import sys
from impacket import smb

C2_URL = "http://mxsyhzt2ytqa6vmwslkd4hcsbqgf22fhgllzkprx2453w7xejkhgjgyd.onion:8080"

def check_smb(ip):
    try:
        conn = smb.SMBConnection(ip, ip, sess_port=445, timeout=8)
        conn.login('', '')
        print(f"[+] {ip}: SMB accessible (MS17-010 likely vulnerable)")
        conn.close()
        return True
    except Exception as e:
        print(f"[-] {ip}: SMB failed - {str(e)}")
        return False

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: ms17_exploit.py <ip>")
        sys.exit(1)
    check_smb(sys.argv[1])